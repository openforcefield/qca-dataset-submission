# OpenFF Gen3 Torsion Set v1.1

### Description

This dataset is a simple-molecule-only dataset, which is a part of Sage torsion parameter training set candidate. 

### General Information

 - Date: 2021.05.07
 - Class: OpenFF TorsionDrive
 - Purpose: For valence parameter optimization 
 - Collection: TorsionDriveDataset
 - Name: OpenFF Gen3 Torsion Set v1.1
 - Number of unique molecules        1352
 - Number of filtered molecules      0
 - Number of torsion drives          1353
 - Number of conformers min mean max 1   2.53 12
 - Dataset Submitter: Hyesu Jang
 - Dataset Generator: Hyesu Jang
 - Set of charges: [-2.0, -1.0, 0.0, 1.0, 2.0]
 - Mean molecular weight: 133.56
 - Max molecular weight: 433.68
 - Enumerate stereoisomers: False
 - Enumerate tautomers: False
 - Enumerate protomers: False (True for 3rd batch of molecules)

### Change log
 - `v1.1`: Additional 464 torsion drives added for (1) a full coverage of single-bond-centered torsion parameters; and for (2) diversity in terms of molecule net charges (negatively charged molecules have been added.)

### Dataset Generation Procedure
This dataset is a simple-molecule-only torsiondrive dataset, aiming to avoid issue of torsion parameter contamination by large internal non-bonded interactions during a valece parameter optimization.
Molecules with one effective rotating bond were generated by combining two simple substituents, which were identified by fragmenting small drug like molecules.
Torsions from the generated molecule set were selected using clustering method, in a way that the dataset can allow a chemical diversity of molecules training each torsion parameter.

#### Step 1. Generation of a list of small and rigid substituents.
(1) For each molecule from an input molecule set(Roche, Coverage, Pfizer Discrepancy and Bayer set), using scaffolds, identified substituents; 
(2) Listed up all substituents; 
(3) Eliminated complex substituents (by checking number of rotatable bonds, number of rings) 
(4) Eliminated uninteresting substituents (1. Hydrazines, 2. Halogen attached to noncarbon, 3. Pentavalent nitrogens, 4. Fluoren isotope, 5. Different halogen atoms attached to the same carbon)

#### Step 2. Generation of small molecules.
Instead of enumerating molecule by adding substituents to a scaffold, molecules were generated by combining two substituents. The bond formed during each combination becomes a center bond, which will be rotated during its torsion scan;

#### Step 3. Elimination of internal hydrogen bond forming molecules.
Generated conformers for each molecule and found and excluded molecules having internal hydrogen bond forming conformers using MDTraj. 

#### Step4. List molecules matching to each torsion parameter and select torsions.
(1) Listed molecules matching to each torsion parameter;
(2) Clustered each list into around 10 clusters using DBSCAN and MACCS keys;
(3) Chose center molecule from each cluster

#### Step5. Generate torsiondrive dataset using qcsubmit.
See below for components used to generate submittable dataset with `openff-qcsubmit`.


### QCSubmit generation pipeline

 - `generate-dataset`: The notebook used to generate the dataset from the input smiles set.

### QCSubmit Manifest
- `1.add-additional-substituents`: Step1 (for second batch). Generation of a list of small and rigid substituents.
- `2.gen-mol-list`: Step2 (for second batch). Generation of small molecules.
- `3.filter-mol-list`: Step3 (for second batch). Elimination of internal hydrogen bond forming molecules.
- `4.select-torsions`: Step4 (for second batch). List molecules matching to each torsion parameter and select torsions.
- `generate-dataset`: Dataset creation notebook with details on decisions made for submission.
- `dataset-expansion-1.json.bz2`: The compressed TorsionDrive dataset ready for submission.
- `dataset-expansion-1.pdf`: A pdf file containing molecule 2D structures.
- `dataset-expansion-1.smi`: SMILES for every molecule in the submission; duplicate molecules for each driven torsion dropped

### Metadata
```
{'collection_type': 'TorsiondriveDataset',
 'creation_date': datetime.date(2021, 5, 7),
 'dataset_name': 'OpenFF Gen3 Torsion Set v1.1',
 'elements': {'C', 'S', 'H', 'N', 'F', 'Cl', 'Br', 'P', 'O'},
 'long_description': 'This dataset is a simple-molecule-only torsiondrive '
                     'dataset, aiming to avoid issue of torsion parameter '
                     'contamination by large internal non-bonded interactions '
                     'during a valece parameter optimization. Molecules with '
                     'one effective rotating bond were generate by combining '
                     'two simple substituents, which were identified by '
                     'fragmenting small drug like molecules. Torsions from the '
                     'generated molecule set were selected using clustering '
                     'method, in a way that the dataset can allow a chemical '
                     'diversity of molecules training each torsion parameter.',
 'long_description_url': HttpUrl('https://github.com/openforcefield/qca-dataset-submission/tree/master/submissions/2021-05-07-OpenFF-Gen3-Torsion-Set-v1.1', scheme='https', host='github.com', tld='com', host_type='domain', path='/openforcefield/qca-dataset-submission/tree/master/submissions/2021-05-07-OpenFF-Gen3-Torsion-Set-v1.1'),
 'short_description': 'OpenFF Gen3 Torsion Set v1.1',
 'submitter': 'hyesujang'}
 ```
 
### QCSpecifications
```
{'basis': 'DZVP',
 'implicit_solvent': None,
 'method': 'B3LYP-D3BJ',
 'program': 'psi4',
 'spec_description': 'Standard OpenFF optimization quantum chemistry '
                     'specification.',
 'spec_name': 'default',
 'store_wavefunction': 'none'}
```

### SCF Properties

```
[<SCFProperties.Dipole: 'dipole'>,
 <SCFProperties.Quadrupole: 'quadrupole'>,
 <SCFProperties.WibergLowdinIndices: 'wiberg_lowdin_indices'>,
 <SCFProperties.MayerIndices: 'mayer_indices'>]
```
